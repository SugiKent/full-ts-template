---
name: 技術スタック更新
description: プロジェクトの依存関係と技術スタックを分析・更新する
category: 開発
tags: [dependencies, upgrade, maintenance]
---

# 技術スタック更新コマンド

あなたは依存関係管理と技術マイグレーションを専門とするシニアソフトウェアエンジニアです。

## コンテキスト

詳細なワークフローとベストプラクティスについては `.claude/skills/update-tech-stack.md` のスキル定義を参照してください。

## タスク

提供された引数に基づいて、プロジェクトの技術スタックを分析および/または更新します。

## 引数

`$ARGUMENTS`

引数が指定されない場合は、デフォルトで `--check` モード（分析のみ）となります。

## 実行ステップ

### ステップ 1: 現状の把握

1. `package.json` を読み取り、現在の依存関係を把握
2. `pnpm outdated` を実行して利用可能な更新をチェック
3. `docs/ARCHITECTURE.md` で技術的な制約を確認

### ステップ 2: 分析とレポート

構造化されたレポートを提供：

```
## 現在の技術スタック概要

### コア依存関係
- Node.js: [engines のバージョン]
- TypeScript: [バージョン]
- React: [バージョン]

### フレームワーク依存関係
- Fastify: [バージョン]
- Vite: [バージョン]
- Prisma: [バージョン]

### 主要ライブラリ
[主要なライブラリとバージョンのリスト]

## 利用可能な更新

### 安全な更新（パッチ）
[現在 -> 利用可能 のリスト]

### マイナー更新
[現在 -> 利用可能 のリスト、新機能をメモ]

### メジャー更新（破壊的変更）
[現在 -> 利用可能 のリスト、マイグレーション要件をメモ]

## 推奨事項

### 即時更新（低リスク）
[今すぐ適用すべき安全な更新のリスト]

### 計画的な更新（中リスク）
[テスト要件付きのマイナー更新リスト]

### メジャーマイグレーション（高リスク）
[完全なマイグレーション計画付きのメジャー更新リスト]
```

### ステップ 3: 更新の実行（--check モードでない場合）

引数に基づいて：
- `--safe`: すべてのパッチ更新を適用
- `--minor`: パッチとマイナー更新を適用
- `--major <package>`: 特定のパッケージを更新

各更新後：
```bash
pnpm run typecheck
pnpm run lint
pnpm run build
pnpm run test
```

### ステップ 4: ドキュメント

更新が適用された場合：
1. ドキュメント内のバージョン参照を更新
2. API の変更や新機能をメモ
3. 重要な変更があれば `ARCHITECTURE.md` を更新

## 安全ガイドライン

1. 複数のメジャーバージョンを同時に更新しない
2. コミット前に必ずビルドが通ることを確認
3. 型パッケージの TypeScript 互換性を確認
4. `engines` フィールドの制約を維持
5. React や TypeScript の更新後は十分にテスト

## 出力

提供するもの：
1. 明確な状態サマリー
2. 実行すべき具体的なコマンド（該当する場合）
3. 警告や懸念事項
4. 次のステップの推奨
